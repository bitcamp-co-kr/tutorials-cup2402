<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Metaverse-AFrame</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="apple-touch-icon" href="/assets/img/apple-icon.png">
    <link rel="shortcut icon" type="image/x-icon" href="/assets/img/favicon.ico">

    <!-- Load fonts style after rendering the layout styles -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;200;300;400;500;700;900&display=swap">
    <link rel="stylesheet" href="/assets/css/fontawesome.min.css">

    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.3.x/dist/aframe-environment-component.min.js"></script>
    <script src="https://unpkg.com/aframe-physics-system@1.6.0/dist/aframe-physics-system.min.js"></script>

    <!-- custom scripts -->
    <script>
        AFRAME.registerComponent('avatar-moving', {
          schema: {
            clips: {idle:'BreathingIdle', walking:'Walking'},
            to: {forward:'0 160 0', backward:'0 0 0', left:'0 -90 0', right:'0 90 0'}
          },
      
          init: function () {
            console.log('init avatar-moving : ', this);
            var data = this.data;
            var el = this.el;
//            this.el.addEventListener('keydown', function (e) {
            document.addEventListener('keydown', function (e) {
                console.log(data.clips);
                switch(e.key){
                case 'w':
                    el.object3D.rotation.copy(data.to.forward);
                    break;
                case 's':
                    el.object3D.rotation.copy(data.to.backward);
                    break;
                case 'a':
                    el.object3D.rotation.copy(data.to.left);
                    break;
                case 'd':
                    el.object3D.rotation.copy(data.to.right);
                    break;
                }
            });
            document.addEventListener('keyup', function (e) {
            });
          }
        });
    </script>

</head>

<body>
    <!-- Start scene    -->
<a-scene physics>
    <!-- assets management system -->
    <a-assets>
        <a-asset-item id="boss" src="/aframe/avatars/theboss/theboss.gltf"></a-asset-item>

    </a-assets>

    <a-camera position="0 1.6 0">
        <a-cursor></a-cursor>
        <a-entity 
            id="avatar" gltf-model="#boss" 
            position="-1 -0.8 -2" rotation="0 170 0" scale="0.01 0.01 0.01"
            animation-mixer="clip: BreathingIdle"
            avatar-moving>
        </a-entity>

    </a-camera>
    
    <a-entity environment="preset: forest; dressingAmount: 500"></a-entity>
</a-scene>
    <!-- End scene    -->    
    
    <!-- Start Script -->
    <script src="/assets/js/jquery-1.11.0.min.js"></script>
    <script src="/assets/js/jquery-migrate-1.2.1.min.js"></script>
    <script src="/assets/js/bootstrap.bundle.min.js"></script>
    <script src="/assets/js/templatemo.js"></script>
    <!-- End Script -->

</body>

</html>