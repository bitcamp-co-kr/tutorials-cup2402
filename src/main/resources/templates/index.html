<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Metaverse-AFrame</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="apple-touch-icon" href="/assets/img/apple-icon.png">
    <link rel="shortcut icon" type="image/x-icon" href="/assets/img/favicon.ico">

    <!-- Load fonts style after rendering the layout styles -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;200;300;400;500;700;900&display=swap">
    <link rel="stylesheet" href="/assets/css/fontawesome.min.css">

    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>    
    <script src="https://unpkg.com/aframe-environment-component@1.3.x/dist/aframe-environment-component.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.2/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-physics-system@v4.2.2/dist/aframe-physics-system.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@3.0.3/dist/aframe-event-set-component.min.js"></script>


</head>

<body>
        <!-- 사용자 컴포넌트 등록 코드는 a-scene 전 body 안에 작성 
            The component name `userComponent` contains uppercase characters, 
            but HTML will ignore the capitalization of attribute names. 
            Change the name to be lowercase: `usercomponent`
        -->
        <script src="/aframe/components/commons.js"></script>
        
        <script>        
           AFRAME.registerComponent('avatar', {
              schema: {
                clip_idle: {default: 'BreathingIdle'}, 
                clip_walking: {default: 'Walking'},
              },          
              init: function () {
                const avatar = this;
                avatar.el.setAttribute('obb-collider', ``);
                document.addEventListener('keydown', function (event) {
                    console.log(event.code);
                  if (event.code === 'KeyW') {
                    avatar.el.object3D.rotation.y = 180*Math.PI/180;
                  }else if(event.code === 'KeyS'){
                    avatar.el.object3D.rotation.y = 0*Math.PI/180;
                  }else if(event.code === 'KeyA'){
                    avatar.el.object3D.rotation.y = 270*Math.PI/180;
                  }else if(event.code === 'KeyD'){
                    avatar.el.object3D.rotation.y = 90*Math.PI/180;
                  }
                  avatar.el.setAttribute('animation-mixer', `clip: ${avatar.data.clip_walking}; loop: repeat`);
                });
                document.addEventListener('keyup', function (event) {
                    avatar.el.setAttribute('animation-mixer', `clip: ${avatar.data.clip_idle}; loop: repeat`);
                });
                console.log('avatar component initialized');
              },
              update: function () {
                console.log('avatar component updated');     
              },
              tick: function (time, timeDelta) {
              },
              tock: function () {
              },
              remove: function () {},
              pause: function () {},
              play: function () {
              }
          });

        </script>

        
        <!-- Start scene    -->
<a-scene physics>
    <!-- assets management system -->
    <a-assets>
        <a-asset-item id="boss" src="/aframe/avatars/theboss/theboss.gltf"></a-asset-item>
        <img id="thumbForest" crossOrigin="anonymous" src="https://cdn.aframe.io/link-traversal/thumbs/forest.png">
    </a-assets>
    <a-entity id="rig" 
        position="0 0 0">
        <a-camera id="camera"
            position="0 1.7 0" rotation="0 0 0"
            >
            <a-entity id="player" gltf-model="#boss" 
                avatar
                position="0 -0.7 -2.4" rotation="0 180 0" scale="0.01 0.01 0.01"
                light="type: ambient; color: #FFF; intensity: 1.2"
                >
            </a-entity>
            <a-text value="CUP Fullstack Program" position="0 0.5 0" color="white"></a-text>
        </a-camera>
    </a-entity>
        

    <!-- 서정욱    -->
    <a-link  portal-url 
        href="/aframe/seo/index.html" image="#thumbForest" title="SEO_JU"
        position="-8.0 1.5 -6.0" rotation="0 0 0"></a-link>
    <!-- 구경모    -->
    <a-link  portal-url 
        href="/aframe/GKM/public/index.html" image="#thumbForest" title="GOO_KM"
        position="-4.0 1.5 -6.0" rotation="0 0 0"></a-link>
    <!-- 이정민    -->
    <a-link  portal-url
        href="/aframe/leejeongmin/index.html" image="#thumbForest" title="LEE_JM"
        position="0.0 1.5 -6.0" rotation="0 0 0"></a-link>
    <!-- 김성형    -->
    <a-link  portal-url
        href="/aframe/shooter_v3/shooter/examples/supercraft/index.html" image="#thumbForest" title="KIM_SH3"
        position="4.0 1.5 -6.0" rotation="0 0 0"></a-link>
    <a-link  portal-url
        href="/aframe/KIM_sh/space-explorer/index.html" image="#thumbForest" title="KIM_SH"
        position="8.0 1.5 -6.0" rotation="0 0 0"></a-link>
        
    <a-entity environment="preset: forest; dressingAmount: 500"></a-entity>
</a-scene>
    <!-- End scene    -->    
    
    <!-- Start Script -->
    <script src="/assets/js/jquery-1.11.0.min.js"></script>
    <script src="/assets/js/jquery-migrate-1.2.1.min.js"></script>
    <script src="/assets/js/bootstrap.bundle.min.js"></script>
    <script src="/assets/js/templatemo.js"></script>
    <!-- End Script -->

    
    <script defer>        
    </script>
</body>

</html>